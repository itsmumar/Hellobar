<%= render 'preview_styles' %>

<script type="text/javascript">

  $(function () {

    $("input").on("change",function(){
        load_styles();
    });

    $("select").on("change",function(){
        load_styles();
    });

    function load_styles(){
      var fontFamily = $("#offer-font-family").val().split(',')[0].replace(/'/g, '');
      $('head').append("<link rel='stylesheet' media='all' href='https://fonts.googleapis.com/css?family=" + fontFamily + "'>");
      $(".hb-cu-offer").css("background-color",$("#offer-background-color").val());
      $(".hb-cu-offer").css("color",$("#offer-text-color").val());
      $(".hb-cu-offer a").css("color",$("#offer-link-color").val());
      $(".hb-cu-modal .cta").css("background-color",$("#modal-button-color").val());
      $(".hb-cu-offer").css("border-color",$("#offer-border-color").val());
      $(".hb-cu-offer").css("border-style",$("#offer-border-style").val());
      $(".hb-cu-offer").css("border-width",$("#offer-border-width").val());
      $(".hb-cu-offer").css("border-radius",$("#offer-border-radius").val());
      $(".hb-cu-offer").css("font-size",$("#offer-font-size").val());
      $(".hb-cu-offer").css("font-weight",$("#offer-font-weight").val());
      $(".hb-cu-offer").css("font-family",$("#offer-font-family").val());
    }

    load_styles();

    $('.hb-cu-modal').show();
  });

</script>


<h2>Style Editor</h2>

<%= form_tag update_styles_site_content_upgrades_path(@site.id), method: "post" do %>
  <div class="content-upgrade-form">

    <div class="columns">
      <div class="form-column">


        <div class="field-wrapper">
          <label for="offer-background-color">Offer Background Color</label>
          <input name="offer_bg_color" id="offer-background-color" type="color" class="style-input js-color-picker-field color-picker-field"
                 value="<%= @styles['offer_bg_color'] || '#ffffb6' %>" >
        </div>

        <div class="select-wrapper">
          <label for="offer-font-family">Offer Font</label>
          <select  name="offer_font_family"  id="offer-font-family"  class="style-input">
            <% ContentUpgrade::AVAILABLE_FONTS.each do |name, value| %>
                <option value="<%=value%>" <% if @styles['offer_font_family'] && @styles['offer_font_family'] == value %>selected="selected"<% end %>><%=name%></option>
            <% end %>
          </select>
        </div>

        <div class="select-wrapper">
          <label for="offer-font-weight">Offer Font Weight</label>
          <select  name="offer_font_weight"  id="offer-font-weight"  class="style-input">
            <% %w[Bold Normal].each do |weight| %>
              <option value="<%=weight.downcase%>" <% if @styles['offer_font_weight'] && @styles['offer_font_weight'] == weight.downcase %>selected="selected"<% end %>><%= weight %></option>
            <% end %>
          </select>
        </div>


        <div class="select-wrapper">
          <label for="offer-font-size">Offer Font Size</label>
          <select  name="offer_font_size" id="offer-font-size" class="style-input">
            <% (10..42).each do |n| %>
                <option value="<%=n%>px" <% if @styles['offer_font_size'] && @styles['offer_font_size'] == n.to_s+'px' %>selected="selected"<% end %>><%=n%>px</option>
            <% end %>
          </select>
        </div>

        <div class="field-wrapper">
          <label for="offer-text-color">Offer Text Color</label>
          <input  name="offer_text_color"  id="offer-text-color" type="color" class="js-color-picker-field color-picker-field"
                 value="<%= @styles['offer_text_color'] || '#666' %>" class="style-input">
        </div>

        <div class="field-wrapper">
          <label for="offer-link-color">Offer Link Color</label>
          <input  name="offer_link_color"  id="offer-link-color" type="color" class="style-input js-color-picker-field color-picker-field" value="<%= @styles['offer_link_color'] || '#1285dd' %>" >
        </div>

        <div class="field-wrapper">
          <label for="offer-border-color">Offer Border Color</label>
          <input name="offer_border_color" id="offer-border-color" type="color" class="style-input js-color-picker-field color-picker-field"
                 value="<%= @styles['offer_border_color'] || '#fff' %>"data-property="offerBorderColor" data-styles="offer">
        </div>

        <div class="select-wrapper">
          <label for="offer-border-width">Offer Border Thickness</label>
          <select  name="offer_border_width" id="offer-border-width" class="style-input">
            <% (0..20).each do |n| %>
            <option value="<%=n%>px" <% if @styles['offer_border_width'] && @styles['offer_border_width'] == n.to_s+'px' %>selected="selected"<% end %>><%=n%>px</option>
            <% end %>
          </select>
        </div>


        <div class="select-wrapper">
          <label for="offer-border-style">Offer Border Style</label>
          <select  name="offer_border_style" id="offer-border-style" class="style-input">
            <% ['solid', 'dotted', 'dashed', 'double'].each do |style| %>
            <option value="<%=style%>" <% if @styles['offer_border_style'] && @styles['offer_border_style'] == style %>selected="selected"<% end %>><%=style%></option>
            <% end %>
          </select>
        </div>

        <div class="select-wrapper">
          <label for="offer-border-radius">Offer Border Radius</label>
          <select name="offer_border_radius" id="offer-border-radius" class="style-input">
            <% (0..20).each do |n| %>
            <option value="<%=n%>px" <% if @styles['offer_border_radius'] && @styles['offer_border_radius'] == n.to_s+'px' %>selected="selected"<% end %>><%=n%>px</option>
            <% end %>
          </select>
        </div>

        <div class="field-wrapper">
          <label for="modal-button-color">Modal Button Color</label>
          <input name="modal_button_color" id="modal-button-color" type="color" class="style-input js-color-picker-field color-picker-field" value="<%= @styles['modal_button_color'] || '#1285dd' %>">
        </div>

      </div>

      <div class="preview-column" style="max-width:900px;">
        <%= render partial: 'preview' %>
      </div>

    </div>

    <div class="buttons">
      <input type="submit" class="save" value="Save">
      <%= link_to('List', site_content_upgrades_path(@site.id), class: "list") %>
    </div>

  </div>

<% end %>
